<h1><%= t('model.ticket_type.title') %></h1>

<%= form_for( Ticket.new ) do |f| %>
  <%= f.hidden_field :ticket_type_id %>
  <%= f.hidden_field :totem_id, :value => params[:totem_id] %>
  <%= f.hidden_field :place_id, :value => params[:place_id] %>
  <table>
    <tr>
      <th><%= t('model.value') %></th>
    </tr>
    <% @ticket_types.each do |ticket_type| %>
      <tr>
        <td><a id="<%= ticket_type.id %>" class="generate" style="cursor: hand;"><%= ticket_type.value %></a></td>
      </tr>
    <% end %>
  </table>
<% end %>

<script type="text/javascript" charset="utf-8">
   jQuery( 'a.generate' ).click( function() { 
    jQuery( '#ticket_ticket_type_id' ).val( this.id );
    param = jQuery( '#new_ticket' ).serialize();
    jQuery.ajax({
      url: "/senhas",
      type: "post",
      data: param,
      dataType: 'json',
      success: function(data){
        ticket = data.ticket;
        jQuery.facebox( '<b>Senha:</b> ' + ticket.value + '<br/> <b>Data/Hora:</b> ' + ticket.created_at_formatted );
      }
    });
  });
</script>
